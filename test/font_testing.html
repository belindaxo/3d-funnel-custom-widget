<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Font Testing</title>
        <script src="https://code.highcharts.com/highcharts.js"></script>
        <script src="https://code.highcharts.com/highcharts-3d.js"></script>
        <script src="https://code.highcharts.com/modules/cylinder.js"></script>
        <script src="https://code.highcharts.com/modules/funnel3d.js"></script>
        <script src="https://code.highcharts.com/modules/exporting.js"></script>
    </head>
    <body>
        <script>
            class MyCustomElement extends HTMLElement {
                constructor() {
                    super();
                    this.attachShadow({ mode: 'open'});
                    
                    const sheet = new CSSStyleSheet();
                    sheet.replaceSync(`
                        @font-face {
                            font-family: '72';
                            src: url('../fonts/72-Regular.woff2') format('woff2');
                        }
                        #container {
                            width: 500px;
                            height: 500px;
                            font-family: '72';
                        }
                    `);
                
                    this.shadowRoot.adoptedStyleSheets = [sheet];

                    this.shadowRoot.innerHTML = `
                        <div id="container"></div>
                    `;

                    this._renderChart();
                }

                _renderChart() {
                    const container = this.shadowRoot.querySelector('#container');
                    Highcharts.chart(container,{
                        chart: {
                            type: 'funnel3d',
                            options3d: {
                                enabled: true,
                                alpha: 10,
                                depth: 50,
                                viewDistance: 50
                            },
                            style: {
                                fontFamily: "'72', sans-serif"
                            }
                        },
                        title: {
                            text: 'Funnel 3D Chart'
                        },
                        subtitle: {
                            text: 'Using custom font in shadow DOM'
                        },
                        plotOptions: {
                            series: {
                                dataLabels: {
                                    enabled: true,
                                    format: '{point.name}: {point.y}',
                                    allowOverlap: false,
                                    padding: 0,
                                },
                                neckWidth: (20 / 50) * 0.7 * 100 + "%",
                                neckHeight: ((20 + 5) / (50 + 20 + 5)) * 100 + "%",
                                width: "70%",
                                height: "80%"
                            }
                        },
                        exporting: {
                            enabled: true,
                        },
                        tooltip: {
                            valueDecimals: 0,
                            followPointer: true,
                            headerFormat: `{series.name}<br/>`,
                        },
                        series: [{
                            name: 'Funnel Series',
                            data: [
                                ['Step 1', 100],
                                ['Step 2', 80],
                                ['Step 3', 60],
                                ['Step 4', 40],
                                ['Step 5', 20]
                            ]
                        }]
                    });
                }
            }
            customElements.define('my-custom-element', MyCustomElement);  
        </script>
        <my-custom-element></my-custom-element>
        <span>I'm not in the shadow DOM</span>
    </body>
</html>